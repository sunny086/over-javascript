# 12-项目实践中使用 TS

## 前序：vscode 插件

TypeScript 项目推荐使用开发工具为 vscode，常用插件有：

- React-Native/React/Redux snippets for es6/es7：react 自动联想工具
- TypeScript Importer：typescript 导入工具
- Vetur：vue 工具
- JavaScript and TypeScript Nightly

## 一 TS 在 Vue 中的使用

==TODO==

## 二 TS 在 React 中的使用

### 2.1 TS 在 React 项目中的使用

生成一个全新的 ts + react 的模版 可直接使用指令：

```txt
create-react-app demo --template typescript
```

旧的 React 项目升级为 TS 语言，则需要手动安装三个依赖，并在根目录创建 `tsconfig.json` 文件，最后将 js 组件 文件后缀修改为 `.tsx` ：

```txt
# 使用 @types/前缀表示我们额外要获取 React 和 React-DOM 的声明文件
npm i -S typescript @types/react @types/react-dom

# tsconfig.json 文件内容
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noFallthroughCasesInSwitch": true,
    "module": "esnext",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx"
  },
  "include": [
    "src"
  ]
}
```

### 2.2 第三方库使用

第三方库大多需要额外安装声明文件，如：

- react-router-dom：需要额外安装声明文件 @types/react-router-dom
- react-redux：需要额外安装声明文件 @types/react-redux

### 2.3 Hello World 组件示例

在 components 文件夹新建一个 `Hello.tsx` 组件文件：

```ts
import React from 'react'

interface IHelloProps {
  msg?: string // ？表示是个可选项
}

interface IHelloState {
  year: number
}

class Hello extends React.Component<IHelloProps, IHelloState> {
  // 这种写法的 state 是可改变的
  public constructor(props: IHelloProps) {
    super(props)
    // const defaultYear :number = 2008
    this.state = {
      year: 2008,
    }
  }

  // 这种写法的 state 是只读的
  // public readonly state: Readonly<IHelloState> = {
  //     count: 2008
  // }

  // 只读 state 的修改
  public changeYear = (): void => {
    let { year } = this.state
    year += 1

    this.setState({
      year,
    })
  }

  // 渲染 props 数据、state 数据
  public render() {
    const { msg } = this.props
    const { year } = this.state

    return (
      <div>
        <div>
          hello {msg}, {year}!
        </div>
        <button onClick={this.changeYear}>点击改变年份</button>
      </div>
    )
  }
}

export default Hello
```

在 `App.tsx` 中使用组件：

```ts
import './App.css'

import Hello from './components/Hello'

function App() {
  return (
    <div className="App">
      <Hello msg="world" />
    </div>
  )
}

export default App
```

### 2.4 函数式组件示例

```ts
import React from 'react'

interface IHelloProps {
  msg?: string // ？表示是个可选项
}

// 使用 FunctionComponent 泛型替换  props:IHelloProps 后，额外获得了：props.children 等属性，更便捷
const Hello: React.FC<IHelloProps> = (props) => {
  return <h3>{props.msg}</h3>
}

Hello.defaultProps = {
  msg: 'Hello World!',
}

export default Hello
```
